<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Message Header Analyzer - Analyze email headers for security and troubleshooting" />
    <meta name="theme-color" content="#0072cc" />
    <title>Message Header Analyzer</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
    <main id="uiToggleFrame" role="main">
        <header class="header-row" role="banner">
            <nav class="button-container" role="toolbar" aria-label="Main actions">
                <fluent-button id="copyButton" title="Copy" aria-label="Copy message header">
                    <span slot="start" class="icon-copy" aria-hidden="true"></span>
                </fluent-button>
                <fluent-button id="settingsButton" title="Settings" aria-label="Open settings">
                    <span slot="start" class="icon-settings" aria-hidden="true"></span>
                </fluent-button>
            </nav>
        </header>

        <section class="frame-row">
            <iframe id="uiFrame" src="newDesktopFrame.html" title="Message Header Analyzer" sandbox="allow-scripts allow-same-origin"></iframe>
        </section>

        <!-- Settings Dialog -->
        <fluent-dialog id="dialog-Settings" aria-label="Settings" hidden>
            <header class="dialog-header">
                <h2 id="settings-title">Settings</h2>
            </header>
            <section class="dialog-content">
                <fieldset>
                    <legend>UI style</legend>
                    <fluent-radio-group orientation="vertical" id="uiChoice" name="uiChoice" aria-label="Choose UI style">
                        <!-- Radio options will be dynamically populated -->
                    </fluent-radio-group>
                    <fluent-checkbox id="telemetryInput">Send telemetry</fluent-checkbox>
                </fieldset>
                <div class="privacy-link">
                    <strong>
                        <small>
                            <a href="privacy.html" target="_blank" rel="noopener noreferrer">privacy policy</a>
                        </small>
                    </strong>
                </div>
            </section>
            <footer class="dialog-actions">
                <fluent-button id="actionsSettings-diag" aria-label="Open diagnostics">diagnostics</fluent-button>
                <fluent-button appearance="accent" id="actionsSettings-OK" aria-label="Save settings and close">OK</fluent-button>
            </footer>
        </fluent-dialog>

        <!-- Diagnostics Dialog -->
        <fluent-dialog id="dialog-Diagnostics" aria-label="Diagnostics" hidden>
            <header class="dialog-header">
                <h2 id="diagnostics-title">Diagnostics</h2>
            </header>
            <section class="dialog-content">
                <div class="code-box">
                    <pre tabindex="0" id="diagpre" aria-label="Diagnostic information" role="textbox" aria-readonly="true"><code id="diagnostics"></code></pre>
                </div>
            </section>
            <footer class="dialog-actions">
                <fluent-button appearance="accent" id="actionsDiag-OK" aria-label="Close diagnostics">OK</fluent-button>
            </footer>
        </fluent-dialog>
    </main>
    <script src="../Scripts/uiToggle.js"></script>
</body>
</html>
